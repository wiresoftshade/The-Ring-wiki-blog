## 2 Модель микрограней

Мы определим нашу BRDF и сравним с измеренными материалами в терминах модели микрограней [30, 7, 33]. Модель микрограней постулирует, что если поверхностное отражение может происходить между заданным вектором света $\boldsymbol l$ и вектором взгляда $\boldsymbol v$, ​​то должна существовать некоторая часть поверхности, или микрогрань, с нормалью, выровненной посередине между векторами $\boldsymbol l$ и $\boldsymbol v$. Этот «половинный вектор», иногда называемый нормалью микроповерхности. Таким образом, определяется как $\boldsymbol h = \frac{l+v}{|l+v|}$. Общая форма модели микрограней для изотропных материалов:

$$f (\boldsymbol l , \boldsymbol v) = \text{diffuse} + \frac{ D(θ_h)F(θ_d)G(θ_l, θ_v) }{ 4cosθ_l cosθ_v}$$

Диффузный член — это функция неизвестной формы. Диффузный Ламберт часто предполагается и представляется постоянным значением. Для зеркального члена $D$ — это функция распределения микрограней, которая отвечает за форму зеркального пика, $F$ — коэффициент отражения Френеля, а $G$ — геометрический коэффициент затухания или затенения.

$θ_l$ и $θ_v$ — углы падения векторов $\boldsymbol l$ и $\boldsymbol v$ относительно нормали, $θ_h$ — угол между нормалью и половинным вектором, а $θ_d$ — угол «разницы» между $\boldsymbol l$ и половинным вектором (или, симметрично, $\boldsymbol v$ и $\boldsymbol h$).

Большинство физически правдоподобных моделей, не описанных специально в форме микрограней, все равно могут быть интерпретированы как модели микрограней, поскольку у них есть функция распределения, фактор Френеля и некоторый дополнительный фактор, который можно считать геометрическим фактором затенения. Единственное реальное различие между моделями микрограней и другими моделями заключается в том, включают ли они явный фактор $\frac{1}{4 cosθ_l cosθ_v}$, который исходит из вывода микрограней. Для моделей, которые не включают этот фактор, подразумеваемый фактор затенения может быть определен путем умножения модели на ${4 cosθ_l cosθ_v}$ после вынесения факторов $D$ и $F$.